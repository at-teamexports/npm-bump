#!/usr/bin/env node

'use strict';

/* eslint-disable no-process-exit */

const minimist = require('minimist');
const npmBump = require('../lib/cli');

const opts = minimist(process.argv.slice(2), {
    alias: {
        r: 'remote',
        b: 'branch',
        p: 'prefix',
        s: 'suffix',
        t: 'type',
        v: 'version',
    },
    default: {
        remote: 'origin',
        branch: 'master',
    },
});

if (opts.version) {
    console.log(`npm-bump ${ require('../package.json').version }`);
    process.exit(0);
}

try {
    npmBump.custom({
        remote: opts.remote || opts._[1],
        branch: opts.branch || opts._[2],
        prefix: opts.prefix,
        suffix: opts.suffix,
    })(opts.type || opts._[0]);
} catch (error) {
    if (error.name === 'UsageError') {
        console.error(error.message);
    } else {
        throw error;
    }
}
